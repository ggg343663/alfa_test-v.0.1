<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ตรวจสอบ QR</title>
</head>
<body>
  <h1>ตรวจสอบ QR</h1>
  <label>QR hash: <input id="hash" size="64"></label><br>
  <label>Public Key: <input id="pubkey" size="64"></label><br>
  <label>Timestamp: <input id="timestamp"></label><br>
  <label>Nonce: <input id="nonce"></label><br>
  <button onclick="verifyHash()">ตรวจสอบ</button>
  <div id="result"></div>
  <script>
    async function sha256Hex(str) {
      const buffer = new TextEncoder().encode(str);
      const hashBuffer = await crypto.subtle.digest('SHA-256', buffer);
      return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2, '0')).join('');
    }
    async function verifyHash() {
      const pub = document.getElementById("pubkey").value.trim();
      const t = document.getElementById("timestamp").value.trim();
      const n = document.getElementById("nonce").value.trim();
      const hash = await sha256Hex(pub + "|" + t + "|" + n);
      const hashInput = document.getElementById("hash").value.trim();
      if(hash === hashInput) {
        document.getElementById("result").innerHTML = `<span style="color:green">✔ ถูกต้อง!</span>`;
      } else {
        document.getElementById("result").innerHTML = `<span style="color:red">✘ ไม่ตรง</span>`;
      }
    }
  </script>
</body>
</html>
