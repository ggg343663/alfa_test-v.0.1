<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏Ç‡∏≠ Master ‡πÉ‡∏´‡∏°‡πà (DTC)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>
  <style>
    body { font-family: sans-serif; max-width: 400px; margin: 2em auto; }
    label, input, button { display: block; margin: 0.6em 0; width: 100%; }
    pre { background: #f8f8f8; padding: 1em; white-space: pre-wrap; }
    .warning {
      background: linear-gradient(90deg, yellow, red);
      padding: 0.5em; color: black; font-weight: bold;
      animation: flash 1s infinite alternate;
      text-align: center; border-radius: 4px;
    }
    @keyframes flash {
      0% { background-color: yellow; }
      100% { background-color: red; }
    }
    small { font-size: 0.9em; color: #555; display: block; margin-top: -0.5em; margin-bottom: 0.8em; }
  </style>
</head>
<body>
  <h2>‡∏Ç‡∏≠ Master ‡πÉ‡∏´‡∏°‡πà</h2>
  <div id="warningBox" class="warning" style="display:none;"></div>

  <form id="requestMasterForm">
    <label>‡∏ä‡∏∑‡πà‡∏≠ Master (‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà): <input type="text" id="masterName" maxlength="8" required></label>
    <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠ Master: <input type="text" id="confirmName" maxlength="8" required></label>
    <label>Public Key (42 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£): <input type="text" id="pubkey" pattern="^0x[a-fA-F0-9]{40}$" required></label>
    <label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô Public Key: <input type="text" id="confirmPubkey" pattern="^0x[a-fA-F0-9]{40}$" required></label>
    <small>üìå ‡∏ú‡∏π‡πâ‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏£‡∏™‡πà‡∏á Public Key ‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå</small>
    <label>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: <input type="text" id="reason"></label>
    <label><input type="checkbox" id="agreePolicy" required> ‡∏â‡∏±‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡πà‡∏≠‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</label>
    <button type="submit">‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Master</button>
  </form>

  <pre id="hashResult"></pre>

  <script>
    let badwordList = {};
    fetch('badwords.json')
      .then(res => res.json())
      .then(data => badwordList = data)
      .catch(() => {
        document.getElementById('warningBox').innerText = '‚ö† ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏°‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
        document.getElementById('warningBox').style.display = 'block';
      });

    function checkBadwords(inputValue) {
      const input = inputValue.toLowerCase();
      let found = [];
      for (const group of Object.values(badwordList)) {
        group.forEach(word => {
          if (input.includes(word)) found.push(word);
        });
      }
      if (found.length > 0) {
        document.getElementById('warningBox').style.display = 'block';
        document.getElementById('warningBox').innerHTML =
          `‚ö† ‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°: <span style="color:red;">${found.join(', ')}</span>`;
      } else {
        document.getElementById('warningBox').style.display = 'none';
      }
    }

    document.getElementById('masterName').addEventListener('input', function () {
      this.value = this.value.toUpperCase();
      checkBadwords(this.value);
    });

    document.getElementById('reason').addEventListener('input', function () {
      checkBadwords(this.value);
    });

    document.getElementById('requestMasterForm').onsubmit = function (e) {
      e.preventDefault();

      const name = document.getElementById('masterName').value.toUpperCase();
      const confirm = document.getElementById('confirmName').value.toUpperCase();
      const pubkey = document.getElementById('pubkey').value.trim();
      const confirmPubkey = document.getElementById('confirmPubkey').value.trim();
      const reason = document.getElementById('reason').value;
      const agreed = document.getElementById('agreePolicy').checked;

      if (name !== confirm) {
        alert('‚ö† ‡∏ä‡∏∑‡πà‡∏≠ Master ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö');
        return;
      }
      if (pubkey !== confirmPubkey) {
        alert('‚ö† Public Key ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö');
        return;
      }
      if (!agreed) {
        alert('‚ö† ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠');
        return;
      }

      const confirmMsg = `üìå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á:\n\n` +
                         `‡∏ä‡∏∑‡πà‡∏≠ Master: ${name}\n` +
                         `Public Key: ${pubkey}\n` +
                         `‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•: ${reason || "(‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏)"}`;
      if (!confirm(confirmMsg)) return;

      const timestamp = new Date().toISOString();
      const nonce = Array.from(crypto.getRandomValues(new Uint8Array(8)))
                         .map(b => b.toString(16).padStart(2, "0")).join('');
      const s = name + pubkey + reason + timestamp + nonce;
      const hash = sha256(s);

      document.getElementById('hashResult').innerText = `
üìå ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ Genesis/Admin ‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô log

Hash ‡∏Ñ‡∏≥‡∏Ç‡∏≠  : ${hash}
Public Key : ${pubkey}
Timestamp  : ${timestamp}
Nonce      : ${nonce}
‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•     : ${reason}`.trim();
    };
  </script>
</body>
</html>
