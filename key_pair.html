<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Generate Address from Passphrase</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 430px; margin: 1.7em auto 0 auto; padding: 0.3em; background-color: #f9f9f9; border-radius: 8px;}
    .back-btn { position: fixed; top: 14px; left: 10px; background: #eee; color: #222; border: 1px solid #ccc; border-radius: 6px; font-size: 1em; padding: 0.4em 1.1em; cursor: pointer; z-index: 1000; box-shadow: 0 2px 8px #0002; transition: background 0.2s;}
    .back-btn:hover { background: #d6f5d6; color: #1a7f3c;}
    h2 { margin-top: 1.2em; margin-bottom: 0.7em; color: #22c55e; font-size: 1.12em;}
    label { font-weight: bold; font-size: 1em; display: block; margin-top: 0.65em; }
    .address-group { background: #e7fbe8; border: 1.2px solid #22c55e; border-radius: 8px; padding: 0.58em 0.77em 0.65em 0.77em; margin-bottom: 0.5em; display: flex; align-items: center; gap: 0.18em;}
    .address-input { font-size: 0.97em; padding: 0.42em 0.6em; border: none; background: transparent; color: #166534; border-radius: 7px; width: 100%; outline: none;}
    .address-btn { background: #22c55e; color: #fff; border: none; border-radius: 7px; padding: 0.37em 0.95em; margin-left: 0.2em; font-weight: 500; font-size: 0.98em; cursor: pointer; height: 32px;}
    .address-btn:hover { background: #16a34a;}
    .yellow-group { background: #fef7e0; border: 1.2px solid #eab308; border-radius: 8px; padding: 0.48em 0.68em 0.6em 0.68em; margin-bottom: 0.44em;}
    .yellow-group label { color: #b58900; }
    .pw-input, .sign-input { font-size: 0.97em; padding: 0.42em 0.6em; border: 1px solid #eab308; background: #fef9c3; color: #854d0e; border-radius: 7px; width: 100%; outline: none; margin-bottom: 0.24em; margin-top: 0.14em;}
    .pw-row { display: flex; align-items: center; gap: 0.4em; margin-bottom: 0.4em;}
    .show-btn { background: #222; color: #fff; border: none; border-radius: 6px; padding: 0.3em 1.1em; font-size: 0.94em; cursor: pointer; margin-left: 0.13em; transition: background 0.14s;}
    .show-btn:hover { background: #444;}
    .red-group { background: #fef2f2; border: 1.2px solid #ef4444; border-radius: 8px; padding: 0.48em 0.68em 0.6em 0.68em; margin-top: 1.35em; margin-bottom: 0.4em; display: flex; align-items: center; gap: 0.3em;}
    .red-label { color: #d20000; font-weight: bold;}
    .red-input { font-size: 0.97em; padding: 0.44em 0.56em; border: none; background: #fde2e2; color: #bb2020; border-radius: 7px; width: 100%; outline: none; filter: blur(7px); transition: filter 0.2s;}
    .red-input.visible { filter: none;}
    .show-red-btn { background: #d20000; color: #fff; border: none; border-radius: 6px; padding: 0.33em 1.15em; font-size: 0.93em; cursor: pointer; font-weight: 500; margin-left: 0.15em; transition: background 0.13s;}
    .show-red-btn:hover { background: #b91c1c;}
    .mini-btn { background: #fff; color: #222; border: 1px solid #bbb; border-radius: 5px; font-size: 0.95em; padding: 0.21em 0.6em; margin-left: 0.1em; cursor: pointer;}
    .mini-btn:hover { background: #f0fdf4; }
    .error { color: #d20000; font-size: 0.95em; margin-top: 0.1em;}
    .status { color: #16a34a; font-size: 0.93em; margin-top: 0.22em; display: none;}
    .strength-bar { height: 7px; width: 100%; border-radius: 6px; background: #eee; margin-top: 0.10em; margin-bottom: 0.16em; overflow: hidden;}
    .strength-bar-inner { height: 100%; border-radius: 6px; transition: width 0.22s;}
    .strength-weak { background: #ef4444; }
    .strength-fair { background: #facc15; }
    .strength-good { background: #22d3ee; }
    .strength-strong { background: #22c55e; }
    .strength-label { font-size: 0.94em; color: #666; text-align: right; margin-bottom: 0.2em;}
    @media (max-width: 520px) {
      body { padding: 0.2em;}
      .address-btn, .show-btn, .show-red-btn { font-size: 0.93em; padding: 0.32em 0.79em;}
    }
  </style>
</head>
<body>
  <button class="back-btn" onclick="history.back()">‚Üê Back</button>
  <h2>üìÆ Address (last 40 chars):</h2>
  <div class="address-group">
    <input id="addressOutput" class="address-input" maxlength="40" readonly />
    <button class="address-btn" onclick="copyAddress()">Copy</button>
  </div>
  <div class="yellow-group">
    <label>Passphrase (6-12 chars, must include letters & numbers):</label>
    <div class="pw-row">
      <input type="password" id="privateKey1" maxlength="12" minlength="6" class="pw-input" autocomplete="off" oninput="updatePwStrength(this.value); clearResult();"/>
      <button class="show-btn" onclick="togglePw('privateKey1', this)">Show</button>
    </div>
    <div class="strength-bar"><div id="pwStrengthBar" class="strength-bar-inner" style="width:0"></div></div>
    <div id="pwStrengthLabel" class="strength-label"></div>
    <label>Confirm Passphrase:</label>
    <div class="pw-row">
      <input type="password" id="privateKey2" maxlength="12" minlength="6" class="pw-input" autocomplete="off" oninput="clearResult();" />
      <button class="show-btn" onclick="togglePw('privateKey2', this)">Show</button>
    </div>
    <label>Sign Code (4 digits):</label>
    <div class="pw-row">
      <input type="password" id="signCode1" maxlength="4" minlength="4" class="sign-input" autocomplete="off" oninput="updateSignStrength(this.value); clearResult();"/>
      <button class="show-btn" onclick="togglePw('signCode1', this)">Show</button>
    </div>
    <div class="strength-bar"><div id="signStrengthBar" class="strength-bar-inner" style="width:0"></div></div>
    <div id="signStrengthLabel" class="strength-label"></div>
    <label>Confirm Sign Code:</label>
    <div class="pw-row">
      <input type="password" id="signCode2" maxlength="4" minlength="4" class="sign-input" autocomplete="off" oninput="clearResult();" />
      <button class="show-btn" onclick="togglePw('signCode2', this)">Show</button>
    </div>
    <button class="mini-btn" style="margin-top:0.42em;margin-bottom:0.15em;" onclick="generateAddress()">üöÄ Generate Address</button>
    <div id="pw1Err" class="error"></div>
    <div id="pw2Err" class="error"></div>
    <div id="sign1Err" class="error"></div>
    <div id="sign2Err" class="error"></div>
    <div id="copyStatus" class="status">‚úÖ Address copied!</div>
  </div>
  <div class="red-group">
    <label class="red-label">üîë Private Key (SHA-256):</label>
    <input id="fullHash" class="red-input" readonly />
    <button class="show-red-btn" onclick="togglePrivateKey(this)">Show</button>
  </div>
  <script>
    // Toggle Show/Hide password fields
    function togglePw(id, btn) {
      const input = document.getElementById(id);
      if (input.type === "password") {
        input.type = "text";
        btn.textContent = "Hide";
      } else {
        input.type = "password";
        btn.textContent = "Show";
      }
    }
    // Toggle show/hide private key (blur effect)
    function togglePrivateKey(btn) {
      const input = document.getElementById('fullHash');
      if (input.classList.contains('visible')) {
        input.classList.remove('visible');
        btn.textContent = "Show";
      } else {
        input.classList.add('visible');
        btn.textContent = "Hide";
      }
    }
    // Copy address
    function copyAddress() {
      const el = document.getElementById('addressOutput');
      if (!el.value) return;
      el.select();
      document.execCommand('copy');
      document.getElementById('copyStatus').style.display = "block";
      setTimeout(()=>document.getElementById('copyStatus').style.display="none",1500);
    }
    // Passphrase strength
    function updatePwStrength(val) {
      const bar = document.getElementById("pwStrengthBar");
      const label = document.getElementById("pwStrengthLabel");
      let score = 0;
      if (val.length >= 6) score++;
      if (/[A-Z]/.test(val)) score++;
      if (/[a-z]/.test(val)) score++;
      if (/\d/.test(val)) score++;
      if (/[^A-Za-z0-9]/.test(val)) score++;
      let width = [0, 25, 45, 65, 85, 100][score];
      let cls = ["", "strength-weak", "strength-fair", "strength-good", "strength-good", "strength-strong"][score];
      let txt = ["Too short", "Weak", "Fair", "Good", "Very Good", "Strong"][score];
      if (!val) { width = 0; cls = ""; txt = ""; }
      bar.style.width = width + "%";
      bar.className = "strength-bar-inner " + cls;
      label.textContent = txt;
    }
    // Sign code strength
    function updateSignStrength(val) {
      const bar = document.getElementById("signStrengthBar");
      const label = document.getElementById("signStrengthLabel");
      const risky = ["0000", "1234", "1111", "2222", "1212", "2580", "5555", "7777"];
      let width = 0, cls = "strength-weak", txt = "";
      if (val.length < 4) {
        width = 0; cls = ""; txt = "";
      } else if (risky.includes(val)) {
        width = 25; cls = "strength-weak"; txt = "Too easy";
      } else if (/^(?:\d)\1{3}$/.test(val)) {
        width = 25; cls = "strength-weak"; txt = "Repeating digits";
      } else if (/^(0123|1234|2345|3456|4567|5678|6789|9876|8765|7654|6543|5432|4321|3210)$/.test(val)) {
        width = 25; cls = "strength-weak"; txt = "Sequential";
      } else {
        width = 100; cls = "strength-strong"; txt = "Strong";
      }
      bar.style.width = width + "%";
      bar.className = "strength-bar-inner " + cls;
      label.textContent = txt;
    }
    // Clear outputs & hide private key when any input changes
    function clearResult() {
      document.getElementById("addressOutput").value = "";
      document.getElementById("fullHash").value = "";
      document.getElementById("fullHash").classList.remove("visible");
      document.querySelector(".show-red-btn").textContent = "Show";
    }
    // Validate and generate address/privateKey
    function validatePassword(pw) {
      return pw.length >= 6 && pw.length <= 12 && /[A-Za-z]/.test(pw) && /\d/.test(pw);
    }
    function validateSign(sign) {
      return /^\d{4}$/.test(sign);
    }
    async function sha256Hex(str) {
      const buffer = new TextEncoder().encode(str);
      const hash = await crypto.subtle.digest("SHA-256", buffer);
      return [...new Uint8Array(hash)].map(b => b.toString(16).padStart(2, '0')).join('');
    }
    async function generateAddress() {
      // Inputs
      const pw1 = document.getElementById("privateKey1").value.trim();
      const pw2 = document.getElementById("privateKey2").value.trim();
      const sign1 = document.getElementById("signCode1").value.trim();
      const sign2 = document.getElementById("signCode2").value.trim();
      const fullHashEl = document.getElementById("fullHash");
      const addressEl = document.getElementById("addressOutput");
      // Errors
      let valid = true;
      document.getElementById("pw1Err").textContent = "";
      document.getElementById("pw2Err").textContent = "";
      document.getElementById("sign1Err").textContent = "";
      document.getElementById("sign2Err").textContent = "";
      if (!validatePassword(pw1)) {
        document.getElementById("pw1Err").textContent = "Must be 6-12 chars, include letters & numbers."; valid = false;
      }
      if (pw1 !== pw2) {
        document.getElementById("pw2Err").textContent = "Passphrases do not match."; valid = false;
      }
      if (!validateSign(sign1)) {
        document.getElementById("sign1Err").textContent = "Sign code must be 4 digits."; valid = false;
      }
      if (sign1 !== sign2) {
        document.getElementById("sign2Err").textContent = "Sign codes do not match."; valid = false;
      }
      if (!valid) return;
      // Generate
      const hash = await sha256Hex(pw1 + sign1);
      const address = "0x" + hash.slice(-40);
      fullHashEl.value = hash;
      addressEl.value = address;
    }
  </script>
</body>
</html>
