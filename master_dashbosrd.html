<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Master QR Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; background: #f7f8fa; margin:0; padding:2em;}
    .container { background:#fff; max-width:750px; margin:auto; border-radius:14px; box-shadow:0 2px 16px #ccd7e8; padding:2.4em 1.5em;}
    h2 { color:#f59e42; margin-bottom:0.2em; letter-spacing:0.03em;}
    .progress-section {
      margin-bottom:2.4em; 
      padding:1.4em 1.2em 1.1em 1.2em;
      background:#f3f5ff;
      border-radius:13px;
      box-shadow:0 1px 6px #e3e5f7;
      font-size:1.08em;
      color:#24344c;
    }
    .progress-block {
      margin-bottom: 1.2em;
      padding-bottom: 1em;
      border-bottom: 1.2px dashed #e0e7ef;
    }
    .progress-block:last-child { border-bottom: none; }
    .progress-title { font-weight:bold; color:#246bfd;}
    .progress-stats { margin-top:0.2em; color:#3b416c;}
    .progress-next {
      color: #f59e42;
      font-size: 1.04em;
      margin-top: 0.16em;
    }
    .summary {
      margin: 1em 0 2.3em 0; font-size: 1.11em; color:#24404c;
      display: flex; gap: 2.8em; justify-content:center;
    }
    .summary > div {
      font-weight:bold; background:#f4f4ff; border-radius: 8px; padding:0.7em 1.2em; box-shadow:0 1px 6px #eee;
      min-width:100px; text-align:center;
    }
    .summary span { font-size: 1.16em; font-weight: bold; color: #3949ab;}
    .search-box { margin-bottom:1.3em; text-align:center;}
    input[type=text] {
      padding:0.55em 0.9em; border-radius:7px; border:1.5px solid #dbeafe; font-size:1em; width:68%; max-width:340px;
      margin-right:0.5em;
      transition: border 0.16s;
    }
    input[type=text]:focus { border-color: #6366f1; outline:none;}
    table { width:100%; border-collapse:collapse; background:#f8fafc; font-size:1.08em;}
    th, td { padding:0.75em 0.38em; text-align:left; }
    th { background:#facc15; color:#222; }
    tr:nth-child(even) { background:#f3f6fa; }
    tr:hover { background:#fffbe5; }
    .status-available { color:#16a34a; font-weight:700;}
    .status-registered { color:#2563eb; font-weight:700;}
    .status-transferred { color:#f59e42; font-weight:700;}
    .back-btn { position: fixed; top: 18px; left: 18px; background: #e3eaf8; color: #232a3e; border: 1.5px solid #b7c5df; border-radius: 7px; font-size: 1em; padding: 0.36em 1.18em; cursor: pointer; transition: background 0.18s; z-index:99;}
    .back-btn:hover { background: #c7f7fa; }
    @media(max-width:700px){
      .container{padding:1em 0.3em;}
      .summary{flex-direction:column;gap:0.7em;}
      th, td{font-size:0.98em;}
      .back-btn { position: static; margin-bottom: 1em;}
      .search-box input[type="text"] { width:95%; max-width:unset; margin-bottom:0.7em; }
      .progress-section {padding:0.8em 0.5em;}
    }
  </style>
</head>
<body>
  <button class="back-btn" onclick="history.back()">‚Üê Back</button>
  <div class="container">
    <h2>üîë Master QR Dashboard</h2>

    <!-- Unlock progress by batch -->
    <div class="progress-section" id="batchProgress"></div>

    <div class="summary">
      <div>Total<br><span id="totalQR">0</span></div>
      <div>Registered<br><span id="regQR">0</span></div>
      <div>Available<br><span id="availQR">0</span></div>
    </div>
    <div class="search-box">
      <input type="text" id="searchBox" placeholder="Search QR hash, owner, or status..." oninput="renderTable()" />
      <button onclick="loadData()">Refresh</button>
    </div>
    <table>
      <thead>
        <tr>
          <th>No.</th>
          <th>Batch</th>
          <th>QR Hash</th>
          <th>Status</th>
          <th>Owner</th>
        </tr>
      </thead>
      <tbody id="qrTable"></tbody>
    </table>
  </div>
<script>
let qrList = [
  {index:1, batch:1, hash:"A9F1...1CDE", status:"registered", owner:"0x0fA...123"},
  {index:2, batch:1, hash:"B8A2...3BAF", status:"available", owner:""},
  {index:3, batch:1, hash:"C4EE...1AF0", status:"registered", owner:"0xB4A...999"},
  {index:4, batch:1, hash:"A013...11AA", status:"available", owner:""},
  {index:5, batch:1, hash:"0A4D...F1B2", status:"transferred", owner:"0x123...DEF"},
  // Batch 2 (example)
  {index:101, batch:2, hash:"C800...BBB2", status:"available", owner:""},
  {index:102, batch:2, hash:"C800...BBB3", status:"registered", owner:"0x5bc...D12"},
  // Batch 3
  {index:2001, batch:3, hash:"D800...BBE4", status:"available", owner:""},
];
const batchConfig = [
  {batch:1, label:"Batch 1 (Limited)", size:100, unlockPercent:0.5, nextBatch:2, nextAmount:2000},
  {batch:2, label:"Batch 2", size:2000, unlockPercent:0.5, nextBatch:3, nextAmount:2000},
  {batch:3, label:"Batch 3", size:2000, unlockPercent:0.5, nextBatch:null, nextAmount:null},
];

function renderBatchProgress() {
  const section = document.getElementById('batchProgress');
  let html = "";
  batchConfig.forEach(cfg => {
    const batchQrs = qrList.filter(q=>q.batch===cfg.batch);
    const reg = batchQrs.filter(q=>q.status==="registered").length;
    const percent = ((reg/cfg.size)*100).toFixed(1);
    html += `<div class="progress-block">
      <span class="progress-title">${cfg.label}:</span>
      <div class="progress-stats">Registered: <b>${reg}/${cfg.size}</b> &nbsp;|&nbsp; <b>${percent}%</b></div>
      ${
        cfg.nextBatch && reg<Math.ceil(cfg.size*cfg.unlockPercent)
          ? `<div class="progress-next">Next unlock: ${cfg.nextAmount} QR when registered ‚â• ${Math.ceil(cfg.size*cfg.unlockPercent)} (${(cfg.unlockPercent*100).toFixed(0)}%)</div>`
          : (cfg.nextBatch?`<div class="progress-next" style="color:#16a34a">Unlocked. Next: Batch ${cfg.nextBatch} (${cfg.nextAmount} QR)</div>`:"")
      }
    </div>`;
  });
  section.innerHTML = html;
}

function loadData() {
  renderBatchProgress();
  renderTable();
}
loadData();

function renderTable() {
  const qrTable = document.getElementById('qrTable');
  const search = (document.getElementById('searchBox')?.value || "").toLowerCase();
  let total = 0, reg = 0, avail = 0;
  let html = qrList.filter(q =>
      q.hash.toLowerCase().includes(search) ||
      (q.owner && q.owner.toLowerCase().includes(search)) ||
      q.status.toLowerCase().includes(search)
    ).map(q => {
      total++;
      if(q.status === "registered") reg++;
      if(q.status === "available") avail++;
      return `<tr>
        <td>${q.index}</td>
        <td>${q.batch}</td>
        <td><code>${q.hash}</code></td>
        <td class="status-${q.status}">${q.status.charAt(0).toUpperCase()+q.status.slice(1)}</td>
        <td>${q.owner ? `<code>${q.owner}</code>` : '-'}</td>
      </tr>`;
    }).join('');
  qrTable.innerHTML = html || `<tr><td colspan="5" style="text-align:center;color:#888;">No data found.</td></tr>`;
  document.getElementById('totalQR').textContent = total;
  document.getElementById('regQR').textContent = reg;
  document.getElementById('availQR').textContent = avail;
}
</script>
</body>
</html>
